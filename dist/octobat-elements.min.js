!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Octobat=e():t.Octobat=e()}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}([function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=n(3),i=n(18),a=Object.prototype.toString;function u(t){return"[object Array]"===a.call(t)}function s(t){return null!==t&&"object"===o(t)}function c(t){return"[object Function]"===a.call(t)}function l(t,e){if(null!=t)if("object"!==o(t)&&(t=[t]),u(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:u,isArrayBuffer:function(t){return"[object ArrayBuffer]"===a.call(t)},isBuffer:i,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===a.call(t)},isFile:function(t){return"[object File]"===a.call(t)},isBlob:function(t){return"[object Blob]"===a.call(t)},isFunction:c,isStream:function(t){return s(t)&&c(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function t(){var e={};function n(n,r){"object"===o(e[r])&&"object"===o(n)?e[r]=t(e[r],n):e[r]=n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return e},deepMerge:function t(){var e={};function n(n,r){"object"===o(e[r])&&"object"===o(n)?e[r]=t(e[r],n):"object"===o(n)?e[r]=t({},n):e[r]=n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return e},extend:function(t,e,n){return l(e,function(e,o){t[o]=n&&"function"==typeof e?r(e,n):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":n(window))&&(o=window)}t.exports=o},function(t,e){var n,o,r=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(t){o=a}}();var s,c=[],l=!1,d=-1;function f(){l&&s&&(l=!1,s.length?c=s.concat(c):d=-1,c.length&&m())}function m(){if(!l){var t=u(f);l=!0;for(var e=c.length;e;){for(s=c,c=[];++d<e;)s&&s[d].run();d=-1,e=c.length}s=null,l=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function p(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new h(t,e)),1!==c.length||l||u(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),o=0;o<n.length;o++)n[o]=arguments[o];return t.apply(e,n)}}},function(t,e,n){"use strict";var o=n(0);function r(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var i;if(n)i=n(e);else if(o.isURLSearchParams(e))i=e.toString();else{var a=[];o.forEach(e,function(t,e){null!=t&&(o.isArray(t)?e+="[]":t=[t],o.forEach(t,function(t){o.isDate(t)?t=t.toISOString():o.isObject(t)&&(t=JSON.stringify(t)),a.push(r(e)+"="+r(t))}))}),i=a.join("&")}if(i){var u=t.indexOf("#");-1!==u&&(t=t.slice(0,u)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";(function(e){var o=n(0),r=n(23),i={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!o.isUndefined(t)&&o.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var u={adapter:function(){var t;return void 0!==e&&"[object process]"===Object.prototype.toString.call(e)?t=n(7):"undefined"!=typeof XMLHttpRequest&&(t=n(7)),t}(),transformRequest:[function(t,e){return r(e,"Accept"),r(e,"Content-Type"),o.isFormData(t)||o.isArrayBuffer(t)||o.isBuffer(t)||o.isStream(t)||o.isFile(t)||o.isBlob(t)?t:o.isArrayBufferView(t)?t.buffer:o.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):o.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};o.forEach(["delete","get","head"],function(t){u.headers[t]={}}),o.forEach(["post","put","patch"],function(t){u.headers[t]=o.merge(i)}),t.exports=u}).call(this,n(2))},function(t,e,n){"use strict";var o=n(0),r=n(24),i=n(4),a=n(26),u=n(27),s=n(8);t.exports=function(t){return new Promise(function(e,c){var l=t.data,d=t.headers;o.isFormData(l)&&delete d["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var m=t.auth.username||"",h=t.auth.password||"";d.Authorization="Basic "+btoa(m+":"+h)}if(f.open(t.method.toUpperCase(),i(t.url,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?a(f.getAllResponseHeaders()):null,o={data:t.responseType&&"text"!==t.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:t,request:f};r(e,c,o),f=null}},f.onabort=function(){f&&(c(s("Request aborted",t,"ECONNABORTED",f)),f=null)},f.onerror=function(){c(s("Network Error",t,null,f)),f=null},f.ontimeout=function(){c(s("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",f)),f=null},o.isStandardBrowserEnv()){var p=n(28),y=(t.withCredentials||u(t.url))&&t.xsrfCookieName?p.read(t.xsrfCookieName):void 0;y&&(d[t.xsrfHeaderName]=y)}if("setRequestHeader"in f&&o.forEach(d,function(t,e){void 0===l&&"content-type"===e.toLowerCase()?delete d[e]:f.setRequestHeader(e,t)}),t.withCredentials&&(f.withCredentials=!0),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){f&&(f.abort(),c(t),f=null)}),void 0===l&&(l=null),f.send(l)})}},function(t,e,n){"use strict";var o=n(25);t.exports=function(t,e,n,r,i){var a=new Error(t);return o(a,e,n,r,i)}},function(t,e,n){"use strict";var o=n(0);t.exports=function(t,e){e=e||{};var n={};return o.forEach(["url","method","params","data"],function(t){void 0!==e[t]&&(n[t]=e[t])}),o.forEach(["headers","auth","proxy"],function(r){o.isObject(e[r])?n[r]=o.deepMerge(t[r],e[r]):void 0!==e[r]?n[r]=e[r]:o.isObject(t[r])?n[r]=o.deepMerge(t[r]):void 0!==t[r]&&(n[r]=t[r])}),o.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(o){void 0!==e[o]?n[o]=e[o]:void 0!==t[o]&&(n[o]=t[o])}),n}},function(t,e,n){"use strict";function o(t){this.message=t}o.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},o.prototype.__CANCEL__=!0,t.exports=o},function(t,e,n){"use strict";e.a=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})}},function(t,e,n){t.exports=n(17)},function(t,e,n){t.exports=n(33)},function(t,e,n){"use strict";(function(t){var e=n(11);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=setTimeout;function i(){}function a(t){if(!(this instanceof a))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function u(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,a._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var o;try{o=n(t._value)}catch(t){return void c(e.promise,t)}s(e.promise,o)}else(1===t._state?s:c)(e.promise,t._value)})):t._deferreds.push(e)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===o(e)||"function"==typeof e)){var n=e.then;if(e instanceof a)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void d(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,l(t)}catch(e){c(t,e)}}function c(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&a._immediateFn(function(){t._handled||a._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)u(t,t._deferreds[e]);t._deferreds=null}function d(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,c(e,t))})}catch(t){if(n)return;n=!0,c(e,t)}}a.prototype.catch=function(t){return this.then(null,t)},a.prototype.then=function(t,e){var n=new this.constructor(i);return u(this,new function(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}(t,e,n)),n},a.prototype.finally=e.a,a.all=function(t){return new a(function(e,n){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var i=r.length;function a(t,u){try{if(u&&("object"===o(u)||"function"==typeof u)){var s=u.then;if("function"==typeof s)return void s.call(u,function(e){a(t,e)},n)}r[t]=u,0==--i&&e(r)}catch(t){n(t)}}for(var u=0;u<r.length;u++)a(u,r[u])})},a.resolve=function(t){return t&&"object"===o(t)&&t.constructor===a?t:new a(function(e){e(t)})},a.reject=function(t){return new a(function(e,n){n(t)})},a.race=function(t){return new a(function(e,n){for(var o=0,r=t.length;o<r;o++)t[o].then(e,n)})},a._immediateFn="function"==typeof t&&function(e){t(e)}||function(t){r(t,0)},a._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)}}).call(this,n(15).setImmediate)},function(t,e,n){(function(t){var o=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(r.call(setTimeout,o,arguments),clearTimeout)},e.setInterval=function(){return new i(r.call(setInterval,o,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(o,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(16),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(1))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var o,r=1,i={},a=!1,u=t.document,s=Object.getPrototypeOf&&Object.getPrototypeOf(t);s=s&&s.setTimeout?s:t,"[object process]"==={}.toString.call(t.process)?o=function(t){e.nextTick(function(){l(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&l(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),o=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){l(t.data)},o=function(e){t.port2.postMessage(e)}}():u&&"onreadystatechange"in u.createElement("script")?function(){var t=u.documentElement;o=function(e){var n=u.createElement("script");n.onreadystatechange=function(){l(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():o=function(t){setTimeout(l,0,t)},s.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var a={callback:t,args:e};return i[r]=a,o(r),r++},s.clearImmediate=c}function c(t){delete i[t]}function l(t){if(a)setTimeout(l,0,t);else{var e=i[t];if(e){a=!0;try{!function(t){var e=t.callback,o=t.args;switch(o.length){case 0:e();break;case 1:e(o[0]);break;case 2:e(o[0],o[1]);break;case 3:e(o[0],o[1],o[2]);break;default:e.apply(n,o)}}(e)}finally{c(t),a=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(1),n(2))},function(t,e,n){"use strict";var o=n(0),r=n(3),i=n(19),a=n(9);function u(t){var e=new i(t),n=r(i.prototype.request,e);return o.extend(n,i.prototype,e),o.extend(n,e),n}var s=u(n(6));s.Axios=i,s.create=function(t){return u(a(s.defaults,t))},s.Cancel=n(10),s.CancelToken=n(31),s.isCancel=n(5),s.all=function(t){return Promise.all(t)},s.spread=n(32),t.exports=s,t.exports.default=s},function(t,e){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},function(t,e,n){"use strict";var o=n(0),r=n(4),i=n(20),a=n(21),u=n(9);function s(t){this.defaults=t,this.interceptors={request:new i,response:new i}}s.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=u(this.defaults,t)).method=t.method?t.method.toLowerCase():"get";var e=[a,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)n=n.then(e.shift(),e.shift());return n},s.prototype.getUri=function(t){return t=u(this.defaults,t),r(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},o.forEach(["delete","get","head","options"],function(t){s.prototype[t]=function(e,n){return this.request(o.merge(n||{},{method:t,url:e}))}}),o.forEach(["post","put","patch"],function(t){s.prototype[t]=function(e,n,r){return this.request(o.merge(r||{},{method:t,url:e,data:n}))}}),t.exports=s},function(t,e,n){"use strict";var o=n(0);function r(){this.handlers=[]}r.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},r.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},r.prototype.forEach=function(t){o.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=r},function(t,e,n){"use strict";var o=n(0),r=n(22),i=n(5),a=n(6),u=n(29),s=n(30);function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return c(t),t.baseURL&&!u(t.url)&&(t.url=s(t.baseURL,t.url)),t.headers=t.headers||{},t.data=r(t.data,t.headers,t.transformRequest),t.headers=o.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return c(t),e.data=r(e.data,e.headers,t.transformResponse),e},function(e){return i(e)||(c(t),e&&e.response&&(e.response.data=r(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,n){"use strict";var o=n(0);t.exports=function(t,e,n){return o.forEach(n,function(n){t=n(t,e)}),t}},function(t,e,n){"use strict";var o=n(0);t.exports=function(t,e){o.forEach(t,function(n,o){o!==e&&o.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[o])})}},function(t,e,n){"use strict";var o=n(8);t.exports=function(t,e,n){var r=n.config.validateStatus;!r||r(n.status)?t(n):e(o("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(t,e,n){"use strict";t.exports=function(t,e,n,o,r){return t.config=e,n&&(t.code=n),t.request=o,t.response=r,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,n){"use strict";var o=n(0),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,i,a={};return t?(o.forEach(t.split("\n"),function(t){if(i=t.indexOf(":"),e=o.trim(t.substr(0,i)).toLowerCase(),n=o.trim(t.substr(i+1)),e){if(a[e]&&r.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}}),a):a}},function(t,e,n){"use strict";var o=n(0);t.exports=o.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(t){var o=t;return e&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=r(window.location.href),function(e){var n=o.isString(e)?r(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},function(t,e,n){"use strict";var o=n(0);t.exports=o.isStandardBrowserEnv()?{write:function(t,e,n,r,i,a){var u=[];u.push(t+"="+encodeURIComponent(e)),o.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),o.isString(r)&&u.push("path="+r),o.isString(i)&&u.push("domain="+i),!0===a&&u.push("secure"),document.cookie=u.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,n){"use strict";var o=n(10);function r(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var n=this;t(function(t){n.reason||(n.reason=new o(t),e(n.reason))})}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var t;return{token:new r(function(e){t=e}),cancel:t}},t.exports=r},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,n){"use strict";n.r(e),n(14),Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,function(n,o){return Array.isArray(o)?n.push.apply(n,t.call(o,e-1)):n.push(o),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var o=n(12),r=n.n(o).a.create({baseURL:"https://pmgw.octobat.com",headers:{"Content-Type":"application/json",Accept:"application/json","Access-Control-Allow-Origin":"true"}}),i=function(t,e,n,o){return"GET"==e&&null!==o&&(t+=(void 0).encodeURI(JSON.parse(o)),o=null),r.request({method:e.toLowerCase(),url:t,data:o})};function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var s=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._octobat=e,this._octobatPublishableKey=null,this._makeFormSubmittable=function(t){n.octobat.formIsSubmittable=!0},this._makeFormDisplayable=function(t){n.octobat.formIsDisplayable=!0}}return function(t,e,n){e&&u(t.prototype,e)}(t,[{key:"bindOctobatForm",value:function(){var t=document.querySelector(this.octobat.formSelector);null!==t&&(this.bindFormIsDisplayable(),this.bindFormIsSubmittable(),this.octobatPublishableKey=t.getAttribute("data-octobat-pkey"),this.octobat.livemode=!/^oc_test_pkey/.test(t.getAttribute("data-octobat-pkey")),null!==t.getAttribute("data-order-id")?this.validateOrder(this.octobat.requestIdentifier):this.createOrder(this.octobat.requestIdentifier),this.getGatewayPkeyAPICall(),this.bindChangeEvents())}},{key:"resetOctobatForm",value:function(){var t=document.querySelector(this.octobat.formSelector);null!==t&&t.removeAttribute("data-order-id")}},{key:"makeAPICall",value:function(t,e,n,o,i,a,u){var s=this;return r.defaults.headers.Authorization="Basic "+btoa(a+":"),"GET"==e&&null!==i&&(t+=this.encodeURI(JSON.parse(i)),i=null),r.request({method:e.toLowerCase(),url:t,data:i}).then(function(t){var e=t.data,n=t.status;u.success(n,e)}).catch(function(t){s.debug(t),u.error(t.response.status,t.response.data)})}},{key:"makeHTTPCall",value:function(t,e,n,o,r,i){var a,u=this;for(var s in null==i&&(i={}),(a=new XMLHttpRequest).onreadystatechange=function(){var t;return 4===a.readyState?(t=u.parseJSON(a.responseText)||a.responseText,a.status>=200&&a.status<300?(i.success||_debug)(a.status,t):a.status>=300&&(i.error||_debug)(a.status,t),void 0!==i.complete&&i.complete(a.status,t)):void 0},"POST"===e?(a.open(e,t,o),a.setRequestHeader("Access-Control-Allow-Origin","true"),a.setRequestHeader("Content-Type","application/json")):(null!==r&&(t+=this.encodeURI(JSON.parse(r)),r=null),a.open(e,t,o)),n)a.setRequestHeader(s,n[s]);return a.send(r)}},{key:"debug",value:function(t){this.octobat.livemode||console.table(t)}},{key:"_debug",value:function(t,e){return console.log(e),alert(e.message||JSON.stringify(e))}},{key:"encodeURI",value:function(t){return"?"+Object.keys(t).reduce(function(e,n){return e.push(n+"="+encodeURIComponent(t[n])),e},[]).join("&")}},{key:"parseJSON",value:function(t){var e;try{e=JSON.parse(t)}catch(t){return!1}return e}},{key:"isIE",value:function(){return!!(window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))}},{key:"sendEvent",value:function(t,e){var n,o;return o=document.querySelector(this.octobat.getFormSelector()),void 0!==window.jQuery?((n=jQuery.Event(t)).detail=e,$(o).trigger(n)):(this.isIE()?(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,e):n=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!0}),o.dispatchEvent(n))}},{key:"getBindedValue",value:function(t){var e;return null!==(e=document.querySelector("[data-octobat='"+t+"']"))&&e.value||""}},{key:"fillBindedFields",value:function(t,e){var n,o;if((n=document.querySelectorAll("."+t)).length>0)for(o=0;o<n.length;)n[o].innerHTML=e,o++}},{key:"validateOrder",value:function(t){var e=this,n=document.querySelector(this.octobat.formSelector),o=n.getAttribute("data-gateway")||"stripe",r=n.getAttribute("data-octobat-pkey"),i=n.getAttribute("data-order-id"),a=JSON.stringify({gateway:o});return this.makeAPICall("".concat(this.octobat.beanieHost,"/orders/").concat(i),"GET",{},!0,a,r,{success:function(n,o){e.debug(o),e.octobat.taxCalculation=o.tax_calculation,e.octobat.taxNumberValidation=o.tax_number_validation,e.octobat.multipleEvidenceCollection=o.multiple_evidence_collection,e.octobat.billingModel=o.billing_model,e.octobat.currency=o.currency,o.discount&&(e.octobat.coupon=o.discount),"recurring"==e.octobat.billingModel&&(e.octobat.billingInterval=o.billing_interval,e.octobat.billingIntervalCount=o.billing_interval_count),e.octobat.multipleEvidenceCollection&&e.getCustomerIPAddress(),e.octobat._setItems(o.items),e.octobat.calculateTaxes().then(function(n){e.sendEvent("form.init.complete.octobat",{request_identifier:t})})},error:function(t,n){e.sendEvent("form.init.failed.octobat",{message:n.message}),e.debug(n.message)}})}},{key:"createOrder",value:function(t){var e=this,n=document.querySelector(this.octobat.formSelector),o=n.getAttribute("data-gateway")||"stripe",r=n.getAttribute("data-octobat-pkey");this.validateOrderParams();var i=JSON.parse(n.getAttribute("data-items"));if(null===i)throw new Error('Implementation Error. Invalid JSON provided for data-items. Right syntax example: `data-items=\'[{"plan": "yourplanid"}]\'`');var u=i.filter(function(t){return t.hasOwnProperty("sku")}),s=i.filter(function(t){return t.hasOwnProperty("charge")}),c=[].concat(a(u),a(s)),l={gateway:o,tax_calculation:this.octobat.taxCalculation,tax_number_validation:this.octobat.taxNumberValidation};if(c.length>0)l.line_items=c;else{var d={subscription_items:i.filter(function(t){return t.hasOwnProperty("plan")})};l.subscription_data=d}var f=JSON.stringify(l);return this.makeAPICall("".concat(this.octobat.beanieHost,"/orders"),"POST",{},!0,f,r,{success:function(o,r){e.debug(r),n.setAttribute("data-order-id",r.id),e.octobat.billingModel=r.billing_model,e.octobat.currency=r.currency,"recurring"==e.octobat.billingModel&&(e.octobat.billingInterval=r.billing_interval_count,e.octobat.billingIntervalCount=r.billing_interval_count),e.octobat._setItems(r.items),e.octobat.calculateTaxes().then(function(n){e.sendEvent("form.init.complete.octobat",{request_identifier:t})})},error:function(t,n){e.sendEvent("form.init.failed.octobat",{message:n.message}),e.debug(n.message)}})}},{key:"validateOrderParams",value:function(){var t=document.querySelector(this.octobat.formSelector);try{JSON.parse(t.getAttribute("data-items"))}catch(t){throw new Error('Implementation Error. Invalid JSON provided for data-items. Right syntax example: `data-items=\'[{"plan": "yourplanid"}]\'`')}if(null!==t.getAttribute("data-tax-calculation")&&!["inclusive","exclusive","with_exemption"].includes(t.getAttribute("data-tax-calculation")))throw new Error("Implementation Error. Invalid data-tax-calculation parameter. Expected: `inclusive`, `exclusive`, `with_exemption`");if(this.octobat.taxCalculation=t.getAttribute("data-tax-calculation")||"exclusive",null!==t.getAttribute("data-multiple-evidence-collection")&&"true"==t.getAttribute("data-multiple-evidence-collection")&&(this.octobat.multipleEvidenceCollection=!0,this.getCustomerIPAddress()),null!==t.getAttribute("data-tax-number-validation")&&!["true","false","format"].includes(t.getAttribute("data-tax-number-validation")))throw new Error("Implementation Error. Invalid data-tax-number-validation parameter. Expected: `true`, `false`, `format`");this.octobat.taxNumberValidation=t.getAttribute("data-tax-number-validation")||!0}},{key:"validateCoupon",value:function(){var t,e=this,n=document.querySelector(this.octobat.getFormSelector()),o=n.getAttribute("data-gateway")||"stripe",r=n.getAttribute("data-octobat-pkey"),i=n.getAttribute("data-order-id"),a=this.getBindedValue("coupon");if(t=null!==this.octobat.billingModel&&"recurring"==this.octobat.billingModel?JSON.stringify({coupon:a,recurring:!0,gateway:o}):JSON.stringify({coupon:a,recurring:!1}),""!=a){var u="".concat(this.octobat.beanieHost,"/orders/").concat(i,"/attach_coupon");this.makeAPICall(u,"POST",{},!0,t,r,{success:function(t,n){e.octobat.coupon=n.coupon,e.sendEvent("form.coupon.valid.octobat",{coupon:n.coupon}),e.fillBindedFields("octobat-coupon-check","OK"),e.octobat.calculateTaxes()},error:function(t,n){e.fillBindedFields("octobat-coupon-check","Invalid or expired coupon"),e.sendEvent("form.coupon.invalid.octobat"),e.octobat.coupon=null,e.octobat.calculateTaxes()}})}else{var s="".concat(this.octobat.beanieHost,"/orders/").concat(i,"/detach_coupon");this.fillBindedFields("octobat-coupon-check",""),this.octobat.coupon=null,this.makeAPICall(s,"DELETE",{},!0,t,r,{success:function(t,n){e.octobat.calculateTaxes()}})}}},{key:"getCustomerIPAddress",value:function(){var t=this,e=document.querySelector(this.octobat.getFormSelector()).getAttribute("data-octobat-pkey");this.makeAPICall(this.octobat.serverHost+"/utils/ip.json","GET",{},!0,null,e,{success:function(e,n){t.octobat.customerIp=n.query,t.octobat.customerIpCountry=n.country_code,t.setSelectedCountry()},error:function(e,n){t.octobat.multipleEvidenceCollection=!1,t.debug(n)}})}},{key:"setSelectedCountry",value:function(){!0===this.octobat.multipleEvidenceCollection?this.getBindedValue("country")==this.octobat.getCustomerPaymentMethodCountry()||this.getBindedValue("country")==this.octobat.getCustomerIPCountry()?this.octobat.selectedCustomerCountry=this.getBindedValue("country"):this.octobat.getCustomerPaymentMethodCountry()==this.octobat.getCustomerIPCountry()&&null!==this.octobat.getCustomerPaymentMethodCountry()?this.octobat.selectedCustomerCountry=this.octobat.getCustomerPaymentMethodCountry():null!==this.getBindedValue("country")?this.octobat.selectedCustomerCountry=this.getBindedValue("country"):this.octobat.selectedCustomerCountry=this.customerIPCountry():null!==this.getBindedValue("country")?this.octobat.selectedCustomerCountry=this.getBindedValue("country"):this.octobat.selectedCustomerCountry=this.customerIPCountry()}},{key:"bindChangeEvents",value:function(){var t=this;null!==document.querySelector(this.octobat.getFormSelector())&&(null!==document.querySelector("[data-octobat='coupon']")&&document.querySelector("[data-octobat='coupon']").addEventListener("change",function(){"pending"==t.octobat.orderStatus&&t.validateCoupon()}),null!==document.querySelector("[data-octobat='country']")&&document.querySelector("[data-octobat='country']").addEventListener("change",function(){"pending"==t.octobat.orderStatus&&(t.setSelectedCountry(),t.octobat.calculateTaxes())}),null!==document.querySelector("[data-octobat='zip']")&&document.querySelector("[data-octobat='zip']").addEventListener("change",function(){"pending"==t.octobat.orderStatus&&t.octobat.calculateTaxes()}),null!==document.querySelector("[data-octobat='tax-number']")&&document.querySelector("[data-octobat='tax-number']").addEventListener("change",function(){"pending"==t.octobat.orderStatus&&t.octobat.calculateTaxes()}))}},{key:"bindFormIsDisplayable",value:function(){void 0!==window.jQuery?$(this.octobat.getFormSelector()).on("form.init.complete.octobat",this._makeFormDisplayable):document.querySelector(this.octobat.getFormSelector()).addEventListener("form.init.complete.octobat",this._makeFormDisplayable)}},{key:"bindFormIsSubmittable",value:function(){void 0!==window.jQuery?$(this.octobat.getFormSelector()).on("form.gateway_pkey.retrieved.octobat",this._makeFormSubmittable):document.querySelector(this.octobat.getFormSelector()).addEventListener("form.gateway_pkey.retrieved.octobat",this._makeFormSubmittable)}},{key:"getGatewayPkeyAPICall",value:function(t){var e=this;null==t&&(t=!0);var n=document.querySelector(this.octobat.getFormSelector()),o=n.getAttribute("data-gateway")||"stripe",r=n.getAttribute("data-octobat-pkey"),i=JSON.stringify({gateway:o,js_version:this.octobat.version});return this.makeAPICall(this.octobat.serverHost+"/tokens/gateway_pkey","GET",{},t,i,r,{success:function(t,n){var o=document.querySelector(e.octobat.getFormSelector());o.setAttribute("data-platform-pkey",n.platform_pkey),o.setAttribute("data-gateway-account",n.uid),e.octobat.authToken=n.token,e.sendEvent("form.gateway_pkey.retrieved.octobat")},error:function(t,n){e.sendEvent("form.gateway_pkey.error.octobat",{message:n.message}),e.debug(n.message)}})}},{key:"confirmOrder",value:function(){var t=this,e=document.querySelector(this.octobat.getFormSelector()),n=(e.getAttribute("data-octobat-pkey"),e.getAttribute("data-gateway"),e.getAttribute("data-order-id")),o="".concat(this.octobat.beanieHost,"/orders/").concat(n,"/confirm");return new Promise(function(e,n){try{t.validateFormElements()}catch(t){return void n(t)}t.octobat.authToken;var r=t.serializeForm();t.debug(r),i(o,"PATCH",0,r).then(function(n){var o=n.data;o.order&&o.order.status&&(t.octobat.orderStatus=o.order.status),e(o)}).catch(function(e){e.response&&402==e.response.status?(t.octobat.detachPaymentMethod(),n(t._handleCardError(e.response))):e.response&&e.response.data.errors.hasOwnProperty("coupon")?n(t._handleCouponError(e.response)):n(e.response)})})}},{key:"_handleCouponError",value:function(t){var e=this,n=document.querySelector(this.octobat.getFormSelector()),o=n.getAttribute("data-octobat-pkey"),r=n.getAttribute("data-order-id"),i=(this.getBindedValue("coupon"),"".concat(this.octobat.beanieHost,"/orders/").concat(r,"/detach_coupon"));return this.fillBindedFields("octobat-coupon-check",""),this.octobat.coupon=null,this.makeAPICall(i,"DELETE",{},!0,{},o,{success:function(t,n){e.octobat.calculateTaxes()}}),{status:t.status,param:"coupon",message:t.data.errors.coupon[0].details,code:t.data.errors.coupon[0].code}}},{key:"_handleCardError",value:function(t){var e={status:t.status};for(var n in t.data.errors)"global"!=n&&(e.param=n),e.message=t.data.errors[n][0].details,e.code=t.data.errors[n][0].code,e.decline_code=t.data.errors[n][0].decline_code,e.next_action=t.data.errors[n][0].next_action;return e}},{key:"validateFormElements",value:function(){if(""===this.getBindedValue("email")||!this.validateEmail(this.getBindedValue("email")))throw new Error("Customer email must be filled and have the right format");if(""===this.getBindedValue("country"))throw new Error("Customer Billing Address Country must be filled")}},{key:"validateEmail",value:function(t){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)}},{key:"serializeForm",value:function(){var t=document.querySelector(this.octobat.getFormSelector()),e={gateway:t.getAttribute("data-gateway")||"stripe"};e.customer={name:this.getBindedValue("name"),email:this.getBindedValue("email"),line1:this.getBindedValue("line1"),line2:this.getBindedValue("line2"),city:this.getBindedValue("city"),zip:this.getBindedValue("zip"),state:this.getBindedValue("state"),country:this.getBindedValue("country")},this.octobat.taxNumberValidation&&!this.octobat.taxIdIsValid?(e.customer.tax_number=null,e.customer.business_type="B2C"):(e.customer.tax_number=""===this.getBindedValue("tax-number")?null:this.getBindedValue("tax-number"),e.customer.business_type=""===this.getBindedValue("tax-number")?"B2C":"B2B");var n=t.getAttribute("data-customer-id")||null;return null!=n&&(e.customer.customer_id=n),e.payment_method=this.octobat.selectedPaymentMethod,JSON.stringify(e)}},{key:"octobat",get:function(){return this._octobat}},{key:"octobatPublishableKey",set:function(t){return r.defaults.headers.Authorization="Basic "+btoa(t+":"),this._octobatPublishableKey=t}}]),t}();function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._octobat=e,this._id=n.id,this._name=n.name,this._currency=n.currency,this._baseAmount=parseInt(n.baseAmount),this._productType=n.productType||"eservice",this._quantity=n.quantity||1,this._taxEvidence=null,this._taxRate=null,this._taxDetails=null,this._taxAmounts=null,this._extrataxAmount=null,this._taxAmount=null,this._taxIncludedAmount=null,this._discountedExtrataxAmount=null,this._discountedTaxAmount=null,this._discountedTaxIncludedAmount=null,this._totalBaseAmount=n.totalBaseAmount}return function(t,e,n){e&&c(t.prototype,e)}(t,[{key:"asJson",value:function(){return{id:this.id,name:this.name,currency:this.currency,baseAmount:this.baseAmount,productType:this.productType,quantity:this.quantity,taxEvidence:this.taxEvidence,taxRate:this.taxRate,tax:this.tax,extrataxAmount:this.extrataxAmount,discountedAmount:this.discountedAmount,netExtrataxAmount:this.netExtrataxAmount,taxAmount:this.taxAmount,taxIncludedAmount:this.taxIncludedAmount,totalBaseAmount:this.totalBaseAmount,taxAmounts:this.taxAmounts,discountedExtrataxAmount:this.discountedExtrataxAmount,discountedTaxAmount:this.discountedTaxAmount,discountedTaxIncludedAmount:this.discountedTaxIncludedAmount}}},{key:"requestTaxEvidence",value:function(){var t=this,e={validate_tax_number:this.octobat.taxNumberValidation,product_type:this.productType,customer_billing_address_country:this.octobat.formHandler.getBindedValue("country"),customer_billing_address_zip:this.octobat.formHandler.getBindedValue("zip"),customer_tax_number:this.octobat.formHandler.getBindedValue("tax-number"),beanie_order_item:this.id};!0===this.octobat.multipleEvidenceCollection&&(this.octobat.selectedPaymentMethod&&(e.payment_source_country=this.octobat.getCustomerPaymentMethodCountry(),e.payment_source_source={gateway:"stripe",source_type:"payment_method",identifier:this.octobat.selectedPaymentMethod}),e.ip_address=this.octobat.getCustomerIP());var n=JSON.stringify(e);return i(this.octobat.serverHost+"/tax_evidence_requests","POST",0,n).then(function(e){var n=e.data;return t.taxRate=n.applied_rate,t.taxEvidence=n.id,t.taxDetails=null!==n.tax_details?n.tax_details.map(function(t){return Object.assign({id:btoa("".concat(t.tax,":").concat(t.name,":").concat(t.rate))},t)}):[],n})}},{key:"computeAmounts",value:function(){"inclusive"==this.octobat.taxCalculation?this.computeInclusiveAmounts():"with_exemption"==this.octobat.taxCalculation?this.computeExemptedAmounts():this.computeExclusiveAmounts()}},{key:"computeInclusiveAmounts",value:function(){var t=this;this.taxRate>0?(this.extrataxAmount=Math.round(this.baseAmount*this.quantity/(1+this.taxRate/100)),this.taxAmount=Math.round(this.extrataxAmount*this.taxRate/100),this.taxIncludedAmount=this.baseAmount*this.quantity):(this.extrataxAmount=this.baseAmount*this.quantity,this.taxAmount=0,this.taxIncludedAmount=this.extrataxAmount),this.discountedTaxIncludedAmount=this.getDiscount(this.taxIncludedAmount),this.taxRate>0?(this.discountedExtrataxAmount=Math.round(this.discountedTaxIncludedAmount/(1+this.taxRate/100)),this.discountedTaxAmount=Math.round(this.discountedExtrataxAmount*this.taxRate/100)):(this.discountedTaxAmount=0,this.discountedExtrataxAmount=this.discountedTaxIncludedAmount),this.taxAmounts=this.taxDetails.map(function(e){return Object.assign({prediscountTaxAmount:e.rate/t.taxRate*t.taxAmount,discountedTaxAmount:e.rate/t.taxRate*t.discountedTaxAmount,postdiscountTaxAmount:e.rate/t.taxRate*(t.taxAmount-t.discountedTaxAmount)},e)}),console.table(this.taxAmounts)}},{key:"computeExemptedAmounts",value:function(){this.octobat.taxIdIsValid&&0==this.taxRate?this.computeExclusiveAmounts():this.computeInclusiveAmounts()}},{key:"computeExclusiveAmounts",value:function(){var t=this;this.extrataxAmount=this.baseAmount*this.quantity,this.taxAmount=Math.round(this.baseAmount*this.quantity*this.taxRate/100),this.taxIncludedAmount=this.extrataxAmount+this.taxAmount,this.discountedExtrataxAmount=this.getDiscount(this.extrataxAmount),this.discountedTaxAmount=Math.round(this.discountedExtrataxAmount)*this.taxRate/100,this.discountedTaxIncludedAmount=this.discountedExtrataxAmount+this.discountedTaxAmount,this.taxAmounts=this.taxDetails.map(function(e){return Object.assign({prediscountTaxAmount:e.rate/t.taxRate*t.taxAmount,discountedTaxAmount:e.rate/t.taxRate*t.discountedTaxAmount,postdiscountTaxAmount:e.rate/t.taxRate*(t.taxAmount-t.discountedTaxAmount)},e)}),console.table(this.taxAmounts),console.table(this.taxAmounts)}},{key:"getDiscountablePercentage",value:function(){return this.baseAmount*this.quantity/this.totalBaseAmount}},{key:"getDiscount",value:function(t){return null===this.octobat.coupon?0:null===this.octobat.coupon.amount_off?Math.round(t*(this.octobat.coupon.percent_off/100)):this.octobat.coupon.amount_off*this.getDiscountablePercentage()}},{key:"octobat",get:function(){return this._octobat}},{key:"productType",get:function(){return this._productType}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"taxRate",get:function(){return this._taxRate},set:function(t){return this._taxRate=t}},{key:"taxDetails",get:function(){return this._taxDetails},set:function(t){return this._taxDetails=t}},{key:"taxAmounts",get:function(){return this._taxAmounts},set:function(t){return this._taxAmounts=t}},{key:"taxEvidence",get:function(){return this._taxEvidence},set:function(t){return this._taxEvidence=t}},{key:"baseAmount",get:function(){return this._baseAmount}},{key:"totalBaseAmount",get:function(){return this._totalBaseAmount}},{key:"quantity",get:function(){return this._quantity}},{key:"extrataxAmount",get:function(){return this._extrataxAmount},set:function(t){return this._extrataxAmount=t}},{key:"taxAmount",get:function(){return this._taxAmount},set:function(t){return this._taxAmount=t}},{key:"taxIncludedAmount",get:function(){return this._taxIncludedAmount},set:function(t){return this._taxIncludedAmount=t}},{key:"discountedExtrataxAmount",get:function(){return this._discountedExtrataxAmount},set:function(t){return this._discountedExtrataxAmount=t}},{key:"discountedTaxAmount",get:function(){return this._discountedTaxAmount},set:function(t){return this._discountedTaxAmount=t}},{key:"discountedTaxIncludedAmount",get:function(){return this._discountedTaxIncludedAmount},set:function(t){return this._discountedTaxIncludedAmount=t}}]),t}();function d(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var f=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._resetAttributes(),this.attachFormHandler()}return function(t,e,n){e&&d(t.prototype,e)}(t,[{key:"_resetAttributes",value:function(){this._version="3.0.4",this._livemode=null,this._serverHost="".concat("https://pmgw.octobat.com"),this._beanieHost="".concat("https://apiv2.octobat.com/beanie"),this._requestIdentifier=null,this._authToken=null,this._formSelector="#octobat-payment-form",this._formHandler=null,this._formIsSubmittable=!1,this._formIsDisplayable=!1,this._taxCalculation="exclusive",this._taxNumberValidation="true",this._multipleEvidenceCollection=!0,this._orderStatus="pending",this._billingModel=null,this._currency=null,this._billingInterval=null,this._billingIntervalCount=null,this._customerIp=null,this._customerIpCountry=null,this._customerPaymentMethodCountry=null,this._selectedCustomerCountry=null,this._taxIdIsValid=null,this._coupon=null,this._items=[],this._availablePaymentMethods=[],this._selectedPaymentMethod=null,this._selectedPaymentMethodType="card",this._transaction={}}},{key:"init",value:function(t){return 1===document.querySelectorAll(t).length&&(this.formSelector=t,this.formHandler.bindOctobatForm(),!0)}},{key:"reset",value:function(){var t=this.formSelector,e=this.formHandler;this._resetAttributes(),this.formSelector=t,this.formHandler=e,null!=this.formHandler&&this.formHandler.resetOctobatForm()}},{key:"attachFormHandler",value:function(){var t=new s(this);this.formHandler=t}},{key:"getFormSelector",value:function(){return this.formSelector}},{key:"getRequestIdentifier",value:function(){return this.requestIdentifier}},{key:"getBillingModel",value:function(){return this.billingModel}},{key:"getVersion",value:function(){return this.version}},{key:"refreshGatewayPKey",value:function(){return this.formHandler.getGatewayPkeyAPICall(!1)}},{key:"refreshCoupon",value:function(){return this.formHandler.validateCoupon()}},{key:"calculateTaxes",value:function(){var t=this;return this._dispatchTaxEvidenceCalls().then(function(e){t._handleTaxIdValidation(e[0]),t._computeAmounts(),t.formHandler.sendEvent("tax.calculation.done.octobat")})}},{key:"_dispatchTaxEvidenceCalls",value:function(){return Promise.all(this.items.map(function(t){return t.requestTaxEvidence()}))}},{key:"_computeAmounts",value:function(){this.items.forEach(function(t){t.computeAmounts()})}},{key:"_handleTaxIdValidation",value:function(t){null!=t.tax_id_validation&&0==t.tax_id_validation.is_valid?(this.formHandler.sendEvent("tax_id.invalid.octobat"),this.taxIdIsValid=!1):null!=t.tax_id_validation?(this.formHandler.sendEvent("tax_id.valid.octobat"),this.taxIdIsValid=!0):this.taxIdIsValid=null}},{key:"_setItems",value:function(t){var e=this;if("recurring"==this.billingModel){var n=t.map(function(t){return t.amount*t.quantity}).reduce(function(t,e){return t+e},0);t.map(function(t){var o={id:t.id,productType:t.product_type,quantity:t.quantity,name:t.description,baseAmount:t.amount,totalBaseAmount:n,currency:t.currency};e._addItem(o)})}else{var o=t.map(function(t){return t.amount*t.quantity}).reduce(function(t,e){return t+e},0);t.map(function(t){if("sku"==t.reference_type){var n={id:t.id,productType:t.product_type,quantity:t.quantity,name:t.description,baseAmount:t.amount,totalBaseAmount:o,currency:t.currency};e._addItem(n)}else{var r={id:t.id,productType:t.product_type,quantity:1,name:t.description,baseAmount:t.amount,totalBaseAmount:o,currency:t.currency};e._addItem(r)}})}}},{key:"_addItem",value:function(t){var e=new l(this,t);this.items.push(e)}},{key:"getCoupon",value:function(){return this.coupon}},{key:"attachPaymentMethod",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.selectedPaymentMethod=t,"pending"==this.orderStatus&&(this.setCustomerPaymentMethodCountry(e),null!=e&&this.multipleEvidenceCollection&&this.calculateTaxes())}},{key:"detachPaymentMethod",value:function(){this.selectedPaymentMethod&&(this.selectedPaymentMethod=null,"pending"==this.orderStatus&&(this.setCustomerPaymentMethodCountry(null),this.multipleEvidenceCollection&&this.calculateTaxes()))}},{key:"getCustomerPaymentMethodCountry",value:function(){return this._customerPaymentMethodCountry}},{key:"setCustomerPaymentMethodCountry",value:function(t){return this._customerPaymentMethodCountry=t,this.formHandler.setSelectedCountry(),this._customerPaymentMethodCountry}},{key:"getCustomerIP",value:function(){return this._customerIp}},{key:"getCustomerIPCountry",value:function(){return this._customerIpCountry}},{key:"setRequestIdentifier",value:function(t){return this._requestIdentifier=t}},{key:"getRequestIdentifier",value:function(){return this._requestIdentifier}},{key:"getSelectedPaymentMethodType",value:function(){return this._selectedPaymentMethodType}},{key:"confirmOrder",value:function(){return this.formHandler.confirmOrder()}},{key:"version",get:function(){return this._version},set:function(t){return this._version=t}},{key:"livemode",get:function(){return this._livemode},set:function(t){return this._livemode=t}},{key:"formSelector",get:function(){return this._formSelector},set:function(t){return this._formSelector=t}},{key:"formHandler",get:function(){return this._formHandler},set:function(t){return this._formHandler=t}},{key:"formIsSubmittable",get:function(){return this._formIsSubmittable},set:function(t){return this._formIsSubmittable=t}},{key:"formIsDisplayable",get:function(){return this._formIsDisplayable},set:function(t){return this._formIsDisplayable=t}},{key:"requestIdentifier",get:function(){return this._requestIdentifier},set:function(t){return this._requestIdentifie=t}},{key:"billingModel",get:function(){return this._billingModel},set:function(t){return this._billingModel=t}},{key:"currency",get:function(){return this._currency},set:function(t){return this._currency=t}},{key:"orderStatus",get:function(){return this._orderStatus},set:function(t){return this._orderStatus=t}},{key:"billingInterval",get:function(){return this._billingInterval},set:function(t){return this._billingInterval=t}},{key:"billingIntervalCount",get:function(){return this._billingIntervalCount},set:function(t){return this._billingIntervalCount=t}},{key:"taxCalculation",get:function(){return this._taxCalculation},set:function(t){return this._taxCalculation=t}},{key:"taxNumberValidation",get:function(){return this._taxNumberValidation},set:function(t){return this._taxNumberValidation=t}},{key:"serverHost",get:function(){return this._serverHost}},{key:"beanieHost",get:function(){return this._beanieHost}},{key:"authToken",get:function(){return this._authToken},set:function(t){return this._authToken=t}},{key:"multipleEvidenceCollection",get:function(){return this._multipleEvidenceCollection},set:function(t){return this._multipleEvidenceCollection=t}},{key:"selectedCustomerCountry",get:function(){return this._selectedCustomerCountry},set:function(t){return this._selectedCustomerCountry=t}},{key:"coupon",get:function(){return this._coupon},set:function(t){return this._coupon=t}},{key:"items",get:function(){return this._items}},{key:"taxIdIsValid",get:function(){return this._taxIdIsValid},set:function(t){return this._taxIdIsValid=t}},{key:"customerIp",set:function(t){return this._customerIp=t}},{key:"customerIpCountry",set:function(t){return this._customerIpCountry=t}},{key:"selectedPaymentMethod",get:function(){return this._selectedPaymentMethod},set:function(t){return this._selectedPaymentMethod=t}},{key:"subtotalExtrataxAmount",get:function(){return this.items.map(function(t){return t.extrataxAmount}).reduce(function(t,e){return t+e},0)}},{key:"subtotalTaxAmount",get:function(){return this.items.map(function(t){return t.taxAmount}).reduce(function(t,e){return t+e},0)}},{key:"subtotalTaxIncludedAmount",get:function(){return this.items.map(function(t){return t.taxIncludedAmount}).reduce(function(t,e){return t+e},0)}},{key:"discountedExtrataxAmount",get:function(){return this.items.map(function(t){return t.discountedExtrataxAmount}).reduce(function(t,e){return t+e},0)}},{key:"discountedTaxAmount",get:function(){return this.items.map(function(t){return t.discountedTaxAmount}).reduce(function(t,e){return t+e},0)}},{key:"discountedTaxIncludedAmount",get:function(){return this.items.map(function(t){return t.discountedTaxIncludedAmount}).reduce(function(t,e){return t+e},0)}},{key:"taxAmounts",get:function(){var t=function(t,e){return t.reduce(function(t,n){var o=n[e];return t[o]=t[o]||[],t[o].push(n),t},{})}(this.items.map(function(t){return t.taxAmounts}).flat(),"id");return Object.keys(t).map(function(e){var n=t[e].map(function(t){return t.prediscountTaxAmount}).reduce(function(t,e){return t+e},0),o=t[e].map(function(t){return t.discountedTaxAmount}).reduce(function(t,e){return t+e},0),r=t[e].map(function(t){return t.postdiscountTaxAmount}).reduce(function(t,e){return t+e},0);return Object.assign({},t[e][0],{prediscountTaxAmount:n,discountedTaxAmount:o,postdiscountTaxAmount:r,taxAmount:r})})}},{key:"totalExtrataxAmount",get:function(){return this.subtotalExtrataxAmount-this.discountedExtrataxAmount}},{key:"totalTaxAmount",get:function(){return this.subtotalTaxAmount-this.discountedTaxAmount}},{key:"totalTaxIncludedAmount",get:function(){return this.subtotalTaxIncludedAmount-this.discountedTaxIncludedAmount}}]),t}());window.onload?(v=window.onload,window.onload=function(){v(),f.formHandler.bindOctobatForm()}):window.onload=function(){f.formHandler.bindOctobatForm()},e.default=f}]).default});